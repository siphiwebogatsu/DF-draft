<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>AFLEARN Introduction to R using ICAN-ICAR 2025 Survey Data</title>
  <meta name="description" content="<p>AFLEARN
Introduction to R using ICAN-ICAR 2025 Survey Data</p>" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="AFLEARN Introduction to R using ICAN-ICAR 2025 Survey Data" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="AFLEARN Introduction to R using ICAN-ICAR 2025 Survey Data" />
  
  
  

<meta name="author" content="Siphiwe M. Bogatsu" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title"><p>AFLEARN
Introduction to R using ICAN-ICAR 2025 Survey Data</p></h1>
<p class="author"><em>Siphiwe M. Bogatsu</em></p>
<p class="date"><em>February 2026</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#introduction" id="toc-introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#survey-design-sampling-and-weighting" id="toc-survey-design-sampling-and-weighting"><span class="toc-section-number">2</span> Survey Design, Sampling, and Weighting</a>
<ul>
<li><a href="#survey-sampling-and-design" id="toc-survey-sampling-and-design"><span class="toc-section-number">2.1</span> Survey sampling and design</a></li>
<li><a href="#survey-weights-and-design-based-inference" id="toc-survey-weights-and-design-based-inference"><span class="toc-section-number">2.2</span> Survey weights and design-based inference</a></li>
<li><a href="#practice-exercises" id="toc-practice-exercises"><span class="toc-section-number">2.3</span> Practice exercises</a></li>
</ul></li>
<li><a href="#understanding-distributions" id="toc-understanding-distributions"><span class="toc-section-number">3</span> Understanding distributions</a>
<ul>
<li><a href="#getting-oriented-to-the-data" id="toc-getting-oriented-to-the-data"><span class="toc-section-number">3.1</span> Getting oriented to the data</a></li>
<li><a href="#variable-types-and-levels-of-measurement" id="toc-variable-types-and-levels-of-measurement"><span class="toc-section-number">3.2</span> Variable types and levels of measurement</a></li>
<li><a href="#distributions-of-continuous-variables" id="toc-distributions-of-continuous-variables"><span class="toc-section-number">3.3</span> Distributions of continuous variables</a>
<ul>
<li><a href="#numeric-summaries" id="toc-numeric-summaries"><span class="toc-section-number">3.3.1</span> Numeric summaries</a></li>
<li><a href="#plots" id="toc-plots"><span class="toc-section-number">3.3.2</span> Plots</a></li>
</ul></li>
<li><a href="#distributions-of-categorical-variables" id="toc-distributions-of-categorical-variables"><span class="toc-section-number">3.4</span> Distributions of categorical variables</a></li>
<li><a href="#weighted-summaries-using-the-survey-design" id="toc-weighted-summaries-using-the-survey-design"><span class="toc-section-number">3.5</span> Weighted summaries using the survey design</a>
<ul>
<li><a href="#weighted-proportions-and-means" id="toc-weighted-proportions-and-means"><span class="toc-section-number">3.5.1</span> Weighted proportions and means</a></li>
<li><a href="#weighted-frequency-tables" id="toc-weighted-frequency-tables"><span class="toc-section-number">3.5.2</span> Weighted frequency tables</a></li>
</ul></li>
<li><a href="#household-level-variables-in-a-child-level-file" id="toc-household-level-variables-in-a-child-level-file"><span class="toc-section-number">3.6</span> Household-level variables in a child-level file</a></li>
<li><a href="#missing-data-and-skip-patterns" id="toc-missing-data-and-skip-patterns"><span class="toc-section-number">3.7</span> Missing data and skip patterns</a></li>
<li><a href="#exercises" id="toc-exercises"><span class="toc-section-number">3.8</span> Exercises</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>AFLEARN
Introduction to R using ICAN-ICAR 2025 Survey Data</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="introduction" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<script>
title=document.getElementById('header');
title.innerHTML = '<img src="files/20260205-df-header.png" alt="">' + title.innerHTML
</script>
<!--chapter:end:index.Rmd-->
</div>
<div id="survey-design-sampling-and-weighting" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Survey Design, Sampling, and Weighting<a href="#survey-design-sampling-and-weighting" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Household surveys such as PAL Network’s ICAN-ICAR study estimate population learning outcomes from a sample. The sampling design determines <em>which</em> households enter the data, and the survey design variables (weights, strata, and clusters) determine <em>how</em> analysts should estimate population quantities and uncertainty. After this chapter, you should be able to explain probability sampling, describe the ICAN-ICAR multi-stage design, interpret a survey weight, and compute design-correct estimates in R.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/2025_PAL_ICAN-ICAR_data.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: One or more parsing issues, call `problems()` on your data frame for details, e.g.:
##   dat &lt;- vroom(...)
##   problems(dat)</code></pre>
<div id="survey-sampling-and-design" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> Survey sampling and design<a href="#survey-sampling-and-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A census measures every household in the population. ICAN-ICAR survey data instead uses a probability sample because a census is rarely feasible at national scale. Probability sampling supports population inference because the design assigns each unit a known (or estimable) selection probability.</p>
<p>ICAN-ICAR survey data uses a stratified, multi-stage cluster design.@fig-pal-sampling-process illustrates the logic.</p>
<div class="figure">
<img src="figs/samplingdesignchart2.png" alt="Illustration of the ICAN-ICAR multi-stage sampling process." width="100%" />
<p class="caption">
(#fig:fig-pal-sampling-process)Illustration of the ICAN-ICAR multi-stage sampling process.
</p>
</div>
<p><strong>Stage 1 (select clusters).</strong> The survey defines primary sampling units (PSUs) such as enumeration areas, villages, or urban blocks. Within strata (for example, region-by-urban/rural categories), the design selects PSUs using probability proportional to size (PPS) so that larger PSUs have a higher chance of selection.</p>
<p><strong>Stage 2 (select households).</strong> Within each selected PSU, the field team selects a fixed number of households using a standardized selection procedure (for example, systematic selection from a listing). This second stage produces the household sample used for data collection.</p>
<p>This design shapes analysis in two ways. First, learners within the same PSU tend to resemble one another, which increases uncertainty relative to a simple random sample of the same size. Second, stratification often improves precision because the sample covers key sub-populations more evenly.</p>
</div>
<div id="survey-weights-and-design-based-inference" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> Survey weights and design-based inference<a href="#survey-weights-and-design-based-inference" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A survey weight approximates how many population units a sampled unit represents. In its simplest form, the design weight equals the inverse of the selection probability. If a household had a 1 in 500 chance of selection, its basic weight would be 500. In other words, that household represents 500 households in the population.The ICAN-ICAR survey data includes a household weight variable, <code>HH_Weight_Provided</code>, which can be used for population estimate.</p>
<p>To compensate for households that were selected but did not respond (or were missed), the weights are adjusted so that responding households “stand in” for similar households that did not respond. This may also involve post-stratification — adjusting weights so
that certain known totals (e.g. population by region, or by urban/rural) align with census figures. These adjustments reduce bias from non-response and any sampling frame imperfections.</p>
<p>Ignoring survey weights or clustering can make your analysis misrepresent both the population estimate and its uncertainty. If selection probabilities vary, unweighted summaries describe the sample rather than the population, whereas weighting targets the population by rebalancing each observation’s contribution. Clustering also induces correlation within PSUs, thus treating the data as a random sample typically understates standard errors and produces confidence intervals that are too narrow. Survey-aware methods incorporates the design to estimate uncertainty correctly.</p>
<p>The <code>svydesign()</code> from the <code>survey</code> package represents the sampling design through a design object. After you create that object, you pass it to survey-aware estimators such as <code>svymean()</code> and <code>svyglm()</code>. In multi-country analysis, cluster and strata identifiers can repeat across countries. The safest approach is to use <code>interaction()</code> so that identifiers become unique across the pooled data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">survey.adjust.domain.lonely =</span> <span class="cn">TRUE</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>des <span class="ot">=</span> <span class="fu">svydesign</span>(</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">ids     =</span> <span class="sc">~</span><span class="fu">interaction</span>(CountryName, VillageID) <span class="sc">+</span> HHID,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">strata  =</span> <span class="sc">~</span><span class="fu">interaction</span>(CountryName, Tier_One_Unit),</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>HH_Weight_Provided,</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="at">data    =</span> dat,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>  <span class="at">nest    =</span> <span class="cn">TRUE</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>)</span></code></pre></div>
<p>Let’s break down each component:</p>
<p><strong>1. <code>ids = ~interaction(CountryName, VillageID) + HHID</code></strong></p>
<p>This specifies the <strong>two-stage cluster structure</strong>:</p>
<ul>
<li><strong>Stage 1:</strong> EAs/Villages (identified uniquely by <code>interaction(CountryName, VillageID)</code>)</li>
<li><strong>Stage 2:</strong> Households within EAs (identified by <code>HHID</code>)</li>
</ul>
<p>We use <code>interaction()</code> to create unique EA identifiers across countries, since the same <code>VillageID</code> might exist in multiple countries. The <code>+</code> indicates nested stages (households within EAs)</p>
<p><strong>2. <code>strata = ~interaction(CountryName, Tier_One_Unit)</code></strong></p>
<p>Stratification variables are the geographic regions within each country. <code>Tier_One_Unit</code> represents the first-level administrative division (provinces, districts, etc.). We interact this with <code>CountryName</code> to treat each country as its own separate stratification system. This ensures that sampling variability is calculated correctly within each country’s design</p>
<p><strong>3. <code>weights = ~HH_Weight_Provided</code></strong></p>
<p>This is the final household weight variable provided in the data. Already incorporates all necessary adjustments (selection probabilities, non-response, post-stratification)</p>
<p><strong>4. <code>nest = TRUE</code></strong></p>
<p>This is essential when cluster IDs are only unique within strata. It tells R that <code>VillageID</code> values can repeat across different strata/countries, and prevents R from treating EAs with the same ID in different countries as the same cluster.</p>
<p>The example below compares an unweighted and weighted estimate of the proportion of enrolled learners who meet minimum proficiency in both maths and reading in Senegal.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># filter to enrolled learners in Senegal</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>one_country <span class="ot">=</span> dat <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">filter</span>(CountryName <span class="sc">==</span> <span class="st">&quot;Senegal&quot;</span> <span class="sc">&amp;</span> enr_status <span class="sc">==</span> <span class="st">&quot;Currently Enrolled&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># unweighted (sample) estimate</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>prop_unweighted <span class="ot">=</span> <span class="fu">mean</span>(one_country<span class="sc">$</span>MPL_both, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>prop_unweighted</span></code></pre></div>
<pre><code>## [1] 0.2603826</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># weighted estimate with design-correct SE</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">survey.adjust.domain.lonely =</span> <span class="cn">TRUE</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>des_one <span class="ot">=</span> <span class="fu">svydesign</span>(</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="at">ids     =</span> <span class="sc">~</span><span class="fu">interaction</span>(CountryName, VillageID) <span class="sc">+</span> HHID,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="at">strata  =</span> <span class="sc">~</span><span class="fu">interaction</span>(CountryName, Tier_One_Unit),</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>HH_Weight_Provided,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="at">data    =</span> one_country,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="at">nest    =</span> <span class="cn">TRUE</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>prop_weighted <span class="ot">=</span> <span class="fu">svymean</span>(<span class="sc">~</span>MPL_both, <span class="at">design =</span> des_one, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a>prop_weighted</span></code></pre></div>
<pre><code>##             mean     SE
## MPL_both 0.26049 0.0109</code></pre>
<p><span class="citation">@fig-pal-analysis-workflow</span> summarizes a practical workflow that you can reuse for descriptive statistics and modelling.</p>
<div class="figure">
<img src="figs/analysisflow_pal.png" alt="A practical workflow for analysing ICAN-ICAR survey data in R." width="85%" />
<p class="caption">
(#fig:fig-pal-analysis-workflow)A practical workflow for analysing ICAN-ICAR survey data in R.
</p>
</div>
<p>After you define <code>des</code>, these are the common <em>survey-aware</em> functions:</p>
<ul>
<li><code>svymean()</code> for weighted means and proportions,</li>
<li><code>svytotal()</code> for weighted totals,</li>
<li><code>svyby()</code> for subgroup estimates, and</li>
<li><code>svyglm()</code> for regression models with design-correct standard errors.</li>
</ul>
</div>
<div id="practice-exercises" class="section level2 hasAnchor" number="2.3">
<h2 class="hasAnchor"><span class="header-section-number">2.3</span> Practice exercises<a href="#practice-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Change the country filter in the example and compare unweighted and weighted MPL estimates.</li>
<li>Estimate the weighted proportion meeting MPL in maths (<code>MPL_math</code>) and compare it with the unweighted proportion.</li>
<li>Within one country, use <code>svyby()</code> to estimate MPL by <code>Location</code> (urban/rural) for enrolled learners.</li>
</ol>
<!--chapter:end:01-survey-design-sampling-weighting.Rmd-->
</div>
</div>
<div id="understanding-distributions" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> Understanding distributions<a href="#understanding-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Large survey datasets contain many variables and many observations. To learn from such data, you need tools that summarise patterns clearly and accurately. This chapter introduces distributions—the way a variable’s values are spread across the sample—and shows how to describe distributions using tables, summary statistics, and simple plots. Because the ICAN-ICAR data come from a complex survey, we also show how to produce weighted summaries that reflect the target population.</p>
<div id="getting-oriented-to-the-data" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Getting oriented to the data<a href="#getting-oriented-to-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Start by checking the size of the dataset and inspecting the variables.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">dim</span>(dat)       <span class="co"># rows and columns</span></span></code></pre></div>
<pre><code>## [1] 89141   142</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">names</span>(dat)[<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>]  <span class="co"># first 25 variable names</span></span></code></pre></div>
<pre><code>##  [1] &quot;CountryName&quot;    &quot;Tier_One_Unit&quot;  &quot;VillageID&quot;      &quot;Location&quot;       &quot;HHID&quot;           &quot;SubmissionDate&quot; &quot;duration&quot;      
##  [8] &quot;hh06a&quot;          &quot;hh06b&quot;          &quot;hh06c&quot;          &quot;hh06d&quot;          &quot;hh07a&quot;          &quot;hh07b&quot;          &quot;hh07c&quot;         
## [15] &quot;hh07d&quot;          &quot;hh07e&quot;          &quot;hh07f&quot;          &quot;hh07g&quot;          &quot;hh07h&quot;          &quot;hh07i&quot;          &quot;hh07j&quot;         
## [22] &quot;hh07k&quot;          &quot;hh07l&quot;          &quot;hh07m&quot;          &quot;hh07n&quot;</code></pre>
<p>A useful next step is to focus on a small set of variables. In this course we frequently use child age (<code>ch02</code>), child sex (<code>ch03</code>), enrolment status (<code>enr_status</code>), and assessment timing variables.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">select</span>(CountryName, Location, HHID, ChildID,</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>         ch02, ch03, ch06a, enr_status,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>         icar_assess_time, ican_assess_time) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 10
##    CountryName Location HHID                               ChildID  ch02  ch03 ch06a enr_status icar_assess_time ican_assess_time
##    &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;                              &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;
##  1 Mozambique  Urban    uuid:f5808f62-6a22-4247-ae68-9eb8… uuid:f…     8     2     4 Currently…            0.783             4.87
##  2 Mozambique  Urban    uuid:b98e2157-5941-457c-8249-cea7… uuid:b…    12     2     6 Currently…            5.52              3.33
##  3 Mozambique  Urban    uuid:26117653-2d45-474f-a7ea-6fa5… uuid:2…     8     1     3 Currently…            1.73              4.33
##  4 Mozambique  Urban    uuid:d46bcfd9-f3e5-44ff-825e-6371… uuid:d…     9     1     5 Currently…            4.22              4.12
##  5 Mozambique  Urban    uuid:df927f9a-f03b-480b-ada3-ddfd… uuid:d…    10     2     2 Currently…            0.617             7.38
##  6 Mozambique  Urban    uuid:ade5f0d8-768a-479c-956b-976e… uuid:a…    13     1     7 Currently…            9.68              7.2 
##  7 Mozambique  Urban    uuid:3f84d69b-e298-43d8-8c77-0ae0… uuid:3…     8     1     3 Currently…            4.9              11.3 
##  8 Mozambique  Urban    uuid:ff7b1d96-0e69-400c-955e-2209… uuid:f…     8     1     3 Currently…            7.28              7.9 
##  9 Mozambique  Urban    uuid:7730b493-addc-4c60-8a8e-9d31… uuid:7…    16     2    10 Currently…            5.12             10.1 
## 10 Mozambique  Urban    uuid:e2108c51-8a38-452a-94f5-dd12… uuid:e…     8     2     1 Currently…            6                18</code></pre>
</div>
<div id="variable-types-and-levels-of-measurement" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> Variable types and levels of measurement<a href="#variable-types-and-levels-of-measurement" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The summary tools you use depend on the type of variable.</p>
<p><strong>Continuous (or continuous-like) variables</strong> represent quantities. Examples include child age (<code>ch02</code>), household size (<code>hh06a</code>), and assessment time (<code>icar_assess_time</code>). Even when a variable records whole numbers (such as household size), it often behaves like a continuous measure because averages and differences remain interpretable.</p>
<p><strong>Categorical variables</strong> group observations into distinct categories. Examples include <code>CountryName</code>, <code>Location</code>, and child sex (<code>ch03</code>). For categorical variables, counts and proportions are more informative than averages.</p>
<p>The ICAN-ICAR data are stored at the child level: each row is a child. Some variables therefore repeat across children in the same household (for example, household size). When you analyse household-level variables, you must avoid counting the same household multiple times.</p>
</div>
<div id="distributions-of-continuous-variables" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> Distributions of continuous variables<a href="#distributions-of-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A distribution summary typically combines (i) a numeric description and (ii) a plot.</p>
<div id="numeric-summaries" class="section level3 hasAnchor" number="3.3.1">
<h3 class="hasAnchor"><span class="header-section-number">3.3.1</span> Numeric summaries<a href="#numeric-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use <code>summary()</code> for a quick overview, then compute statistics that match your question.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">summary</span>(dat<span class="sc">$</span>ch02)              <span class="co"># child age</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    5.00    7.00   10.00   10.04   13.00   16.00</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">summary</span>(dat<span class="sc">$</span>icar_assess_time)  <span class="co"># ICAR assessment time</span></span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   0.000   1.683   4.067   5.569   7.000 675.717    2827</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    <span class="at">mean_age   =</span> <span class="fu">mean</span>(ch02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>    <span class="at">sd_age     =</span> <span class="fu">sd</span>(ch02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>    <span class="at">p25_age    =</span> <span class="fu">quantile</span>(ch02, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>    <span class="at">median_age =</span> <span class="fu">median</span>(ch02, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>    <span class="at">p75_age    =</span> <span class="fu">quantile</span>(ch02, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   mean_age sd_age p25_age median_age p75_age
##      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
## 1     10.0   3.22       7         10      13</code></pre>
</div>
<div id="plots" class="section level3 hasAnchor" number="3.3.2">
<h3 class="hasAnchor"><span class="header-section-number">3.3.2</span> Plots<a href="#plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Histograms and density plots show shape (skewness, clustering, and outliers).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> ch02)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Child age (years)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="figs/fig-age-hist-1.png" alt="Distribution of child age in the ICAN-ICAR sample." width="576" />
<p class="caption">
(#fig:fig-age-hist)Distribution of child age in the ICAN-ICAR sample.
</p>
</div>
</div>
</div>
<div id="distributions-of-categorical-variables" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> Distributions of categorical variables<a href="#distributions-of-categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For categorical variables, start with a frequency table and then compute proportions.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># raw counts</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>ch03, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## 
##     1     2 
## 45213 43928</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>Location, <span class="at">useNA =</span> <span class="st">&quot;ifany&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Rural Urban 
## 49781 39360</code></pre>
<p>It is usually clearer to attach labels. For example, <code>ch03</code> is typically coded 1/2 for Female/Male.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>    <span class="at">sex =</span> <span class="fu">factor</span>(ch03, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>)),</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>    <span class="at">residence =</span> <span class="fu">factor</span>(Location, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Rural&quot;</span>, <span class="st">&quot;Urban&quot;</span>))</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  )</span></code></pre></div>
<p>Now you can create clean frequency tables.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>sex_tbl <span class="ot">=</span> dat <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">count</span>(sex) <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">kable</span>(sex_tbl, <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Count&quot;</span>, <span class="st">&quot;Percent&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Sex</th>
<th align="right">Count</th>
<th align="right">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Female</td>
<td align="right">45213</td>
<td align="right">50.7</td>
</tr>
<tr class="even">
<td align="left">Male</td>
<td align="right">43928</td>
<td align="right">49.3</td>
</tr>
</tbody>
</table>
</div>
<div id="weighted-summaries-using-the-survey-design" class="section level2 hasAnchor" number="3.5">
<h2 class="hasAnchor"><span class="header-section-number">3.5</span> Weighted summaries using the survey design<a href="#weighted-summaries-using-the-survey-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Unweighted summaries describe the sample. To describe the population, you must account for weights, clustering, and stratification.</p>
<p>We create a survey design object using the same structure used elsewhere in the course.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="at">survey.lonely.psu =</span> <span class="st">&quot;adjust&quot;</span>,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="at">survey.adjust.domain.lonely =</span> <span class="cn">TRUE</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>des_child_all <span class="ot">=</span> <span class="fu">svydesign</span>(</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="at">ids     =</span> <span class="sc">~</span><span class="fu">interaction</span>(CountryName, VillageID) <span class="sc">+</span> HHID,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="at">strata  =</span> <span class="sc">~</span><span class="fu">interaction</span>(CountryName, Tier_One_Unit),</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>  <span class="at">weights =</span> <span class="sc">~</span>HH_Weight_Provided,</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>  <span class="at">data    =</span> dat,</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>  <span class="at">nest    =</span> <span class="cn">TRUE</span></span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>)</span></code></pre></div>
<div id="weighted-proportions-and-means" class="section level3 hasAnchor" number="3.5.1">
<h3 class="hasAnchor"><span class="header-section-number">3.5.1</span> Weighted proportions and means<a href="#weighted-proportions-and-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A weighted proportion of girls in the population:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span><span class="fu">I</span>(ch03 <span class="sc">==</span> <span class="dv">1</span>), des_child_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##                      mean     SE
## I(ch03 == 1)FALSE 0.51713 0.0032
## I(ch03 == 1)TRUE  0.48287 0.0032</code></pre>
<p>Weighted means for several continuous variables:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span>ch02 <span class="sc">+</span> icar_assess_time <span class="sc">+</span> ican_assess_time, des_child_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##                     mean     SE
## ch02             10.0037 0.0238
## icar_assess_time  5.8671 0.1045
## ican_assess_time  7.7783 0.1302</code></pre>
</div>
<div id="weighted-frequency-tables" class="section level3 hasAnchor" number="3.5.2">
<h3 class="hasAnchor"><span class="header-section-number">3.5.2</span> Weighted frequency tables<a href="#weighted-frequency-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Weighted distributions use <code>svytable()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>country_w <span class="ot">=</span> <span class="fu">svytable</span>(<span class="sc">~</span>CountryName, des_child_all)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>country_w_tbl <span class="ot">=</span> <span class="fu">tibble</span>(</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  <span class="at">CountryName =</span> <span class="fu">names</span>(country_w),</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  <span class="at">weighted_n  =</span> <span class="fu">as.numeric</span>(country_w),</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  <span class="at">percent     =</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">prop.table</span>(country_w))</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>)</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a><span class="fu">kable</span>(country_w_tbl, <span class="at">digits =</span> <span class="dv">1</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;Weighted count&quot;</span>, <span class="st">&quot;Percent&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Country</th>
<th align="right">Weighted count</th>
<th align="right">Percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bangladesh</td>
<td align="right">46534652</td>
<td align="right">17.9</td>
</tr>
<tr class="even">
<td align="left">Kenya</td>
<td align="right">18133333</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td align="left">Mali</td>
<td align="right">3703030</td>
<td align="right">1.4</td>
</tr>
<tr class="even">
<td align="left">Mexico</td>
<td align="right">51275864</td>
<td align="right">19.7</td>
</tr>
<tr class="odd">
<td align="left">Mozambique</td>
<td align="right">9694001</td>
<td align="right">3.7</td>
</tr>
<tr class="even">
<td align="left">Nepal</td>
<td align="right">16370232</td>
<td align="right">6.3</td>
</tr>
<tr class="odd">
<td align="left">Nicaragua</td>
<td align="right">1132365</td>
<td align="right">0.4</td>
</tr>
<tr class="even">
<td align="left">Pakistan</td>
<td align="right">53312701</td>
<td align="right">20.5</td>
</tr>
<tr class="odd">
<td align="left">Senegal</td>
<td align="right">4097044</td>
<td align="right">1.6</td>
</tr>
<tr class="even">
<td align="left">Tanzania</td>
<td align="right">24984302</td>
<td align="right">9.6</td>
</tr>
<tr class="odd">
<td align="left">Uganda</td>
<td align="right">31361665</td>
<td align="right">12.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="household-level-variables-in-a-child-level-file" class="section level2 hasAnchor" number="3.6">
<h2 class="hasAnchor"><span class="header-section-number">3.6</span> Household-level variables in a child-level file<a href="#household-level-variables-in-a-child-level-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When a household-level variable repeats across children, a child-level frequency table over-weights large households. A simple fix is to keep one record per household.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">|&gt;</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="fu">arrange</span>(HHID, ChildID) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  <span class="fu">group_by</span>(HHID) <span class="sc">|&gt;</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hh_first =</span> <span class="fu">row_number</span>() <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>For example, compare a child-level and household-level distribution of roof type (<code>hh07a</code>), if that variable is available in your extract.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># child-level distribution (counts children)</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>  <span class="fu">count</span>(hh07a) <span class="sc">|&gt;</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co"># household-level distribution (counts households once)</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>  <span class="fu">filter</span>(hh_first) <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  <span class="fu">count</span>(hh07a) <span class="sc">|&gt;</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<p>To produce a weighted household-level distribution, subset the survey design to one row per household.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>des_household <span class="ot">=</span> <span class="fu">subset</span>(des_child_all, hh_first)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>roof_w <span class="ot">=</span> <span class="fu">svytable</span>(<span class="sc">~</span>hh07a, des_household)</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>  <span class="at">roof_type =</span> <span class="fu">names</span>(roof_w),</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>  <span class="at">percent   =</span> <span class="fu">as.numeric</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">prop.table</span>(roof_w))</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="missing-data-and-skip-patterns" class="section level2 hasAnchor" number="3.7">
<h2 class="hasAnchor"><span class="header-section-number">3.7</span> Missing data and skip patterns<a href="#missing-data-and-skip-patterns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Missing values are common in survey data. In ICAN-ICAR, missingness often reflects skip patterns. For example, grade (<code>ch06a</code>) is usually recorded only for learners who are currently enrolled.</p>
<p>Start by checking how much is missing.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>    <span class="at">missing_ch06a =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(ch06a)),</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>    <span class="at">missing_pct =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(ch06a)) <span class="sc">/</span> <span class="fu">n</span>()</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   total missing_ch06a missing_pct
##   &lt;int&gt;         &lt;int&gt;       &lt;dbl&gt;
## 1 89141          9915        11.1</code></pre>
<p>Then evaluate whether missingness aligns with enrolment status.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>dat <span class="sc">|&gt;</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>  <span class="fu">group_by</span>(enr_status) <span class="sc">|&gt;</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>    <span class="at">total =</span> <span class="fu">n</span>(),</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>    <span class="at">missing_ch06a =</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(ch06a)),</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>    <span class="at">missing_pct =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(ch06a)) <span class="sc">/</span> <span class="fu">n</span>()</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   enr_status         total missing_ch06a missing_pct
##   &lt;chr&gt;              &lt;int&gt;         &lt;int&gt;       &lt;dbl&gt;
## 1 Currently Enrolled 79397           171       0.215
## 2 Never Enrolled      7517          7517     100    
## 3 Out of School       2227          2227     100</code></pre>
<p>You can also estimate weighted missingness rates by subgroup.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">svyby</span>(</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  <span class="sc">~</span><span class="fu">I</span>(<span class="fu">is.na</span>(ch06a)),</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="sc">~</span>enr_status,</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  des_child_all,</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  svymean,</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##                            enr_status I(is.na(ch06a))FALSE I(is.na(ch06a))TRUE se.I(is.na(ch06a))FALSE se.I(is.na(ch06a))TRUE
## Currently Enrolled Currently Enrolled            0.9991602        0.0008397509            0.0001091877           0.0001091877
## Never Enrolled         Never Enrolled            0.0000000        1.0000000000            0.0000000000           0.0000000000
## Out of School           Out of School            0.0000000        1.0000000000            0.0000000000           0.0000000000</code></pre>
</div>
<div id="exercises" class="section level2 hasAnchor" number="3.8">
<h2 class="hasAnchor"><span class="header-section-number">3.8</span> Exercises<a href="#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Use the ICAN-ICAR data and the tools in this chapter to answer the questions below.</p>
<ol style="list-style-type: decimal">
<li>What proportion of the sample is rural (<code>Location == "Rural"</code>)? Compute both the unweighted and weighted estimate.</li>
<li>What is the unweighted and weighted mean child age (<code>ch02</code>) for enrolled learners (<code>enr_status == "Currently Enrolled"</code>)?</li>
<li>Create an age group variable (for example, <code>&lt;= 10</code> vs <code>&gt; 10</code>). What share of learners falls in each age group?</li>
<li>Produce a weighted frequency table for <code>Location</code> within one country of your choice.</li>
<li>Investigate missingness in <code>ch06a</code> by <code>residence</code> and by <code>sex</code>. Report the results as unweighted and weighted proportions.</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># Example template: weighted rural proportion</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">svymean</span>(<span class="sc">~</span><span class="fu">I</span>(Location <span class="sc">==</span> <span class="st">&quot;Rural&quot;</span>), des_child_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="sc">&lt;!--</span>chapter<span class="sc">:</span>end<span class="sc">:</span><span class="dv">02</span><span class="sc">-</span>understanding<span class="sc">-</span>distributions.Rmd<span class="sc">-</span><span class="ot">-&gt;</span></span></code></pre></div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
